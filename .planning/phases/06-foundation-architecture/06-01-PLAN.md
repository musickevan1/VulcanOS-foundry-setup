---
phase: 06-foundation-architecture
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - vulcan-appearance-manager/Cargo.toml
  - vulcan-appearance-manager/src/main.rs
  - vulcan-appearance-manager/src/app.rs
  - vulcan-appearance-manager/src/models/mod.rs
  - vulcan-appearance-manager/src/models/theme.rs
  - vulcan-appearance-manager/src/models/color_group.rs
  - vulcan-appearance-manager/src/services/mod.rs
  - vulcan-appearance-manager/src/services/theme_parser.rs
  - vulcan-appearance-manager/src/services/theme_storage.rs
  - vulcan-appearance-manager/src/services/theme_applier.rs
  - vulcan-appearance-manager/src/components/mod.rs
autonomous: true

must_haves:
  truths:
    - "vulcan-appearance-manager crate exists with merged models from both apps"
    - "Theme model (Theme struct with 50+ fields) is importable from the merged crate"
    - "Theme services (parser, storage, applier) are importable from the merged crate"
    - "Wallpaper models (Monitor, Wallpaper, WallpaperProfile) remain importable"
    - "Wallpaper services (hyprctl, hyprpaper, profile_storage, thumbnail, image_splitter) remain importable"
    - "cargo check passes on the merged crate with zero errors"
  artifacts:
    - path: "vulcan-appearance-manager/Cargo.toml"
      provides: "Merged dependencies from both crates"
      contains: "name = \"vulcan-appearance-manager\""
    - path: "vulcan-appearance-manager/src/models/theme.rs"
      provides: "Theme struct with all color/config fields"
      contains: "pub struct Theme"
    - path: "vulcan-appearance-manager/src/models/color_group.rs"
      provides: "ColorGroup and ColorField types for editor UI"
      contains: "pub struct ColorGroup"
    - path: "vulcan-appearance-manager/src/services/theme_parser.rs"
      provides: "Bash script parser for theme files"
      contains: "pub fn parse_theme_file"
    - path: "vulcan-appearance-manager/src/services/theme_storage.rs"
      provides: "Theme file CRUD operations"
      contains: "pub fn load_all_themes"
    - path: "vulcan-appearance-manager/src/services/theme_applier.rs"
      provides: "Theme apply/preview/revert via vulcan-theme CLI"
      contains: "pub fn apply_theme"
  key_links:
    - from: "vulcan-appearance-manager/src/models/mod.rs"
      to: "theme.rs, color_group.rs"
      via: "pub use re-exports"
      pattern: "pub use theme::Theme"
    - from: "vulcan-appearance-manager/src/services/mod.rs"
      to: "theme_parser, theme_storage, theme_applier"
      via: "pub mod declarations"
      pattern: "pub mod theme_parser"
---

<objective>
Rename vulcan-wallpaper-manager to vulcan-appearance-manager and merge theme-manager models and services into the unified crate.

Purpose: Establish the single unified crate that all subsequent Phase 6 plans and Phases 7-10 build upon. The wallpaper-manager is the more mature codebase (8 plans shipped) and becomes the base. Theme-manager services and models are absorbed. Theme-manager components are NOT moved yet (Phase 7 UI work). The old vulcan-theme-manager crate directory is left intact for now (deletion is a separate cleanup concern).

Output: A compiling vulcan-appearance-manager crate with all wallpaper AND theme models/services available.
</objective>

<execution_context>
@/home/evan/.claude/get-shit-done/workflows/execute-plan.md
@/home/evan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-foundation-architecture/06-CONTEXT.md
@.planning/phases/06-foundation-architecture/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename crate and merge Cargo.toml</name>
  <files>vulcan-appearance-manager/Cargo.toml</files>
  <action>
  Rename the vulcan-wallpaper-manager directory to vulcan-appearance-manager:
  ```
  mv vulcan-wallpaper-manager vulcan-appearance-manager
  ```

  Then update Cargo.toml:
  1. Change `name = "vulcan-wallpaper-manager"` to `name = "vulcan-appearance-manager"`
  2. Update `description` to "VulcanOS unified appearance manager - themes and wallpapers"
  3. Add the `regex = "1"` dependency from theme-manager (the ONLY missing dependency)
  4. All other dependencies are already present (gtk4, libadwaita, relm4, serde, serde_json, toml, anyhow, dirs, tokio, image, lazy_static all exist in wallpaper-manager already)
  5. Update the app ID in main.rs from `"com.vulcanos.wallpaper-manager"` to `"com.vulcanos.appearance-manager"`

  Do NOT add any dependencies beyond `regex = "1"`. Both crates use identical versions for all shared deps.
  Do NOT modify any source logic yet -- this task is purely the rename and Cargo.toml merge.
  </action>
  <verify>
  Run `cargo check` in the vulcan-appearance-manager directory. It should pass (only change is crate name and adding regex dep, which has no effect on existing code).
  Verify: `grep 'name = "vulcan-appearance-manager"' vulcan-appearance-manager/Cargo.toml` returns a match.
  Verify: `grep 'regex' vulcan-appearance-manager/Cargo.toml` returns a match.
  </verify>
  <done>
  - vulcan-appearance-manager/ directory exists (renamed from vulcan-wallpaper-manager/)
  - Cargo.toml has name "vulcan-appearance-manager" and includes regex dependency
  - main.rs has updated app ID
  - `cargo check` passes with zero errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Move theme models into merged crate</name>
  <files>
  vulcan-appearance-manager/src/models/mod.rs
  vulcan-appearance-manager/src/models/theme.rs
  vulcan-appearance-manager/src/models/color_group.rs
  </files>
  <action>
  Copy theme model files from vulcan-theme-manager into the merged crate:

  1. Copy `vulcan-theme-manager/src/models/theme.rs` to `vulcan-appearance-manager/src/models/theme.rs`
  2. Copy `vulcan-theme-manager/src/models/color_group.rs` to `vulcan-appearance-manager/src/models/color_group.rs`
  3. Update `vulcan-appearance-manager/src/models/mod.rs` to add the new modules:
     ```rust
     mod monitor;
     mod wallpaper;
     mod profile;
     mod theme;
     mod color_group;

     pub use monitor::Monitor;
     pub use wallpaper::Wallpaper;
     pub use profile::WallpaperProfile;
     pub use theme::Theme;
     pub use color_group::{ColorGroup, ColorField};
     ```

  The theme.rs and color_group.rs files should work as-is -- they have no `crate::` imports that need path changes. They use only `serde`, `std::path::PathBuf`, and static data.

  Do NOT modify the content of theme.rs or color_group.rs. They compile standalone.
  </action>
  <verify>
  Run `cargo check` in vulcan-appearance-manager/. It should pass.
  Verify the types are accessible:
  ```bash
  grep "pub use theme::Theme" vulcan-appearance-manager/src/models/mod.rs
  grep "pub use color_group" vulcan-appearance-manager/src/models/mod.rs
  ```
  </verify>
  <done>
  - theme.rs and color_group.rs exist in vulcan-appearance-manager/src/models/
  - models/mod.rs re-exports Theme, ColorGroup, ColorField
  - `cargo check` passes
  </done>
</task>

<task type="auto">
  <name>Task 3: Move theme services into merged crate</name>
  <files>
  vulcan-appearance-manager/src/services/mod.rs
  vulcan-appearance-manager/src/services/theme_parser.rs
  vulcan-appearance-manager/src/services/theme_storage.rs
  vulcan-appearance-manager/src/services/theme_applier.rs
  </files>
  <action>
  Copy theme service files from vulcan-theme-manager into the merged crate:

  1. Copy `vulcan-theme-manager/src/services/theme_parser.rs` to `vulcan-appearance-manager/src/services/theme_parser.rs`
  2. Copy `vulcan-theme-manager/src/services/theme_storage.rs` to `vulcan-appearance-manager/src/services/theme_storage.rs`
  3. Copy `vulcan-theme-manager/src/services/theme_applier.rs` to `vulcan-appearance-manager/src/services/theme_applier.rs`

  4. Update `vulcan-appearance-manager/src/services/mod.rs` to add the new modules:
     ```rust
     pub mod hyprctl;
     pub mod hyprpaper;
     pub mod image_splitter;
     pub mod profile_storage;
     pub mod thumbnail;
     pub mod theme_parser;
     pub mod theme_storage;
     pub mod theme_applier;
     ```

  The service files use `crate::models::Theme` and `crate::services::theme_parser` / `crate::services::theme_applier` paths. These will resolve correctly in the merged crate because:
  - `crate::models::Theme` is re-exported from models/mod.rs (Task 2)
  - `crate::services::theme_parser` and `crate::services::theme_applier` are declared as sibling modules

  theme_storage.rs imports `crate::services::{theme_parser, theme_applier}` -- these are now siblings in the same services/ directory. No path changes needed.

  theme_parser.rs uses `crate::models::Theme` -- available via mod.rs re-export from Task 2. No path changes needed.

  theme_applier.rs has no crate-level imports beyond anyhow and std. No changes needed.

  Do NOT modify service file content. They should compile as-is after Tasks 1 and 2.
  </action>
  <verify>
  Run `cargo check` in vulcan-appearance-manager/. It must pass with zero errors.
  Run `cargo test` to verify the existing theme_parser tests (test_parse_theme, test_serialize_theme) pass.
  ```bash
  cargo test --manifest-path vulcan-appearance-manager/Cargo.toml
  ```
  </verify>
  <done>
  - theme_parser.rs, theme_storage.rs, theme_applier.rs exist in vulcan-appearance-manager/src/services/
  - services/mod.rs declares all 8 service modules
  - `cargo check` passes with zero errors
  - `cargo test` passes (existing parser tests work in new location)
  </done>
</task>

</tasks>

<verification>
After all 3 tasks:
1. `cargo check --manifest-path vulcan-appearance-manager/Cargo.toml` passes with zero errors
2. `cargo test --manifest-path vulcan-appearance-manager/Cargo.toml` passes (parser tests)
3. `grep 'name = "vulcan-appearance-manager"' vulcan-appearance-manager/Cargo.toml` matches
4. All 5 model types accessible: Monitor, Wallpaper, WallpaperProfile, Theme, ColorGroup
5. All 8 service modules declared: hyprctl, hyprpaper, image_splitter, profile_storage, thumbnail, theme_parser, theme_storage, theme_applier
</verification>

<success_criteria>
- vulcan-appearance-manager crate compiles with all merged code
- Theme struct with 50+ fields is importable from the crate
- Theme parser, storage, and applier services are importable
- All existing wallpaper functionality preserved (models + services unchanged)
- Existing tests pass in the new crate location
</success_criteria>

<output>
After completion, create `.planning/phases/06-foundation-architecture/06-01-SUMMARY.md`
</output>
